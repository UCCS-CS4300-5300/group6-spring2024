<!-- NOTE! The hyperlink <a> tag that's needed to add the route to the Item Details page is currently found on line 81 of this template. -->

{% extends 'templates/base_template.html' %}

{% block content %}
<style>
  .card-row {
    max-width: 78%;
    margin: 0 auto;
  }

  .img-fluid {
    height: 100px;
    object-fit: cover;
    width: auto;
  }

  .bottom-btn {
    margin-left: 10.44%;
    margin-top: 1.5%;
    margin-bottom: 3%;
  }

  .location-details {
    display: flex;
    flex-direction: column;
    margin: auto;
    padding: 10px;
    border-bottom-left-radius: 15px;
    border-bottom-right-radius: 15px;
    background-color: #D95A2B;
  }


  .flex-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
  }

  .location-description {
    display: flex;
    flex-wrap: nowrap;
  }
  
  .directions-btn {
    display: flex;
    margin-right: 10px; /* Adjusts spacing to the container edge */
    padding: 5px 10px; /* Smaller padding for a compact look */
    font-size: 0.75rem; /* Smaller font size */
  }
  
  @media (max-width: 768px) {
    .img-fluid {
      width: 100%; /* Full width on smaller screens */
      height: auto; /* Adjusts height automatically */
    }

    .col-md-2, .col-md-8 {
      flex: 0 0 100%;
      max-width: 100%;
    }
  }
  
  @media (max-width: 364px) {
    .directions-btn {
      padding: 4px 8px;
      font-size: 0.7rem;
      margin-right: 8px; 
  }
</style>

<div class="container text-center">
  <h1 style="margin-top:65px;">{{ location.name }}</h1>

  <!-- Main image -->
  <div class="row">
    <div class="col"></div>
    <div class="col-6 bg-light">
      <div class="ratio ratio-1x1" style="max-width: 366px; margin: auto;">
        <div class="d-flex justify-content-center align-items-center bg-light" style="height: 100%;">
          <img src="{{location.image.url}}" class="img-fluid" alt="Location Image"/>
        </div>
      </div>
    </div>
    <div class="col"></div>
  </div>

  <!-- Rectangular section for location details with adjusted structure -->
  <div class="row">
    <div class="col"></div>
    <div class="col-6">
      <div class="location-details" style="margin-left: -12px; margin-right: -12px;">
        <div class="flex-row"> 
          
          <!-- Address and Directions Line -->
          <div class="location-description">
            {% if location.address %}
              <strong style="margin-right: 5px">Address:</strong>{{ location.address }}
            {% else %}
              <strong>Location Address Not Present, Please Contact An Administrator</strong>
            {% endif %}
          </div>
          <a class="btn custom-btn directions-btn" href="https://www.google.com/maps/search/?api=1&query={{ location.address|urlencode }}" target="_blank">Directions</a>
        </div>

        <!-- Location Description Line -->
        <div class="location-description">
          {% if location.description %}
            <strong style="margin-right: 5px">Description:</strong>{{location.description}}
          {% else %}
            <strong style="color: #f8f9fa;">There is no description for this location yet.</strong>
          {% endif %}
        </div>

        <!-- Location Tags Line -->
        <div class="location-description">
          <strong style="margin-right: 5px">Tags:</strong>
          {% if location.tags.exists %}
            {% for tag in location.tags.all %}
              {{ tag.name }}{% if not forloop.last %},{% endif %}
            {% endfor %}
          {% else %}
            <strong style="color: #f8f9fa;">None</strong>
          {% endif %}
        </div>
      </div>
    </div>
    <div class="col"></div>
  </div>

  <!-- Add Item button -->
  <div class="row">
    <div class="col"></div>
    <div class="col-7" style="height: 48px;"></div>
    <div class="col position-relative">
      <a class="btn custom-btn custom-btn-smaller position-absolute bottom-0 start-0 mb-3" href="{% url 'add_item' %}">Add Item</a>
    </div>
  </div>

  <!-- Item List -->
  {% if items %}
    {% for item in items %}
  <div class="row justify-content-center mb-0">
    <div class="card card-row m-0 position-relative">
      <div class="row">
        <div class="col-2 d-flex align-items-center justify-content-center">
          <img src="https://harmlessharvest.com/cdn/shop/files/harmless-harvest-12oz-organic-pink-coconut-water.png" class="img-fluid rounded-start" alt="{{ item.name }}">
        </div>
        <div class="col d-flex align-items-center ms-1 justify-content-center"> 
          <div class="card-body text-start">
            <h2 class="card-title mb-0">{{ item.name }}</h2>
          </div>
        </div>
      </div>
      <a href="{% url 'item_info' item.id %}" class="stretched-link"></a>

    </div>
  </div>
    {% endfor %}
  {% else %}
  <div class="row justify-content-center mb-0">
    <div class="card card-row m-0 position-relative">
      <div class="row">
        <div class="col-2 d-flex align-items-center justify-content-center">
        </div>
        <div class="col d-flex align-items-center ms-1 justify-content-center"> 
          <div class="card-body text-start">
            <h3 class="card-title mb-0">No items exist yet for this location.</h3>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div>
<div class=container>
  <button class="btn custom-btn custom-btn-smaller bottom-btn" onclick="window.history.back();">Back</button>
</div>

<p></p>
<p></p>

<h2 class="row justify-content-center text-center"> Reviews </h2> 
{% for review in reviews %}
<div class="row justify-content-center mb-0">
  <div class="card card-row m-0 position-relative">
    <div class="row">
      <div class="d-flex align-items-center justify-content-center">
        <div class="card-body text-start">
          <h3 class="card-title mb-0"">{{review.user}}</h3>
          <p class="card-body">{{ review.review }}</p>
          <p class="card-body">Stars: {{ review.num_stars }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endfor %}
<p></p>
<p></p>
<!--Add review button -->
<div class="row">
  <div class="col"></div>
    <div class="col-7" style="height: 48px;"></div>
      <div class="col position-relative">
    <a class="btn custom-btn custom-btn-smaller position-absolute bottom-0 start-0 mb-3" href="{% url 'add_review' %}">Add Review</a>
      </div>
  </div>


<button class="btn custom-btn custom-btn-smaller bottom-btn" onclick="window.history.back();">Back</button>
{% endblock %}
